#SERIES DE TIEMPO MULTIPLE

#IVAN RAMON JARDON RODRIGUEZ

#IMPORTAR SERIE
BIMBO<-ts(read.csv("C:\\Users\\SAQLA-C12\\Desktop\\BIMBO.csv",header=TRUE), frequency=252,start=2000)
plot(BIMBO)


#DESCOMPONER MODELO ADITIVO Y MULTIPLICATIVO
BIMBO_ADITIVO<-decompose(BIMBO)
BIMBO_MULTIPLICATIVO<-decompose(BIMBO,type = "mult")

#GRAFICARLOS
plot(BIMBO_ADITIVO)
plot(BIMBO_MULTIPLICATIVO)

#EXTRAER LA TENDENCIA, ESTACIONALIDAD, ALEATORIEDAD (ADITIVO)
TENDENCIA_ADITIVO<-BIMBO_ADITIVO$trend
ESTACIONALIDAD_ADITIVO<-BIMBO_ADITIVO$seasonal
ALEATORIEDAD_ADITIVO<-BIMBO_ADITIVO$random

#EXTRAER LA TENDENCIA, ESTACIONALIDAD, ALEATORIEDAD (MULTIPLICATIVO)
TENDENCIA_MULTIPLICATIVO<-BIMBO_MULTIPLICATIVO$trend
ESTACIONALIDAD_MULTIPLICATIVO<-BIMBO_MULTIPLICATIVO$seasonal
ALEATORIEDAD_MULTIPLICATIVO<-BIMBO_MULTIPLICATIVO$random

#EXPORTARLA A EXCEL
ADITIVO<-data.frame(TENDENCIA_ADITIVO,ESTACIONALIDAD_ADITIVO,ALEATORIEDAD_ADITIVO)
MULTIPLICATIVO<-data.frame(TENDENCIA_MULTIPLICATIVO,ESTACIONALIDAD_MULTIPLICATIVO,ALEATORIEDAD_MULTIPLICATIVO)


install.packages("XLConnect")
require(XLConnect)
exportar<-loadWorkbook("BIMBO_ADITIVO_MULTIPLICATIVO.xlsx",create=TRUE)

#EXPORTAR TABLA 1
createSheet(exportar, "ADITIVO")
createName(exportar,name="ADITIVO", formula="ADITIVO!$A$1")
writeNamedRegion(exportar,ADITIVO,name = "ADITIVO")
#EXPORTAR TABLA 2
createSheet(exportar, "MULTIPLICATIVO")
createName(exportar,name="MULTIPLICATIVO", formula="MULTIPLICATIVO!$A$1")
writeNamedRegion(exportar,MULTIPLICATIVO,name = "MULTIPLICATIVO")

#GUARDAD LIBRO EXCEL
saveWorkbook(exportar)

#GRAFICAR TENDENCIA Y TENDENCIA*ESTACIONALIDAD EN R
ts.plot(cbind(TENDENCIA_ADITIVO,TENDENCIA_ADITIVO*ESTACIONALIDAD_ADITIVO),lty=6:2,col=cbind(10,50),main="ADITIVO")
ts.plot(cbind(TENDENCIA_MULTIPLICATIVO,TENDENCIA_MULTIPLICATIVO*ESTACIONALIDAD_MULTIPLICATIVO),lty=6:2,col=cbind(10,50),main="MULTIPLICATIVO")



